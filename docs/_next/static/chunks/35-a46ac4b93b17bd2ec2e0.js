"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[35],{82720:function(e,t,n){n.d(t,{U:function(){return l}});var r=n(67294),i=n(29163),o=n(18538),a=n(94184),s=n.n(a),c=n(85893);var l=r.memo((0,i.ZP)((function(e){var t=e.className,n=e.onClickUpFile,r=e.onClickUpFolder,i=e.disabled;return r?(0,c.jsx)(o.Z,{className:s()(t,{disabled:i}),pointing:"top",icon:null,basic:!0,text:"Upload",children:(0,c.jsxs)(o.Z.Menu,{children:[(0,c.jsx)(o.Z.Item,{text:"File",icon:(0,c.jsx)("span",{className:"icon cru-fo-file"}),onClick:n}),(0,c.jsx)(o.Z.Item,{text:"Folder",icon:(0,c.jsx)("span",{className:"icon cru-fo-folder"}),onClick:r})]})}):(0,c.jsx)("div",{className:s()("btn-upload",{disabled:i},t),onClick:n,children:"Upload"})})).withConfig({displayName:"BtnUpload",componentId:"sc-wp55x1-0"})(["&.btn-upload,&.ui.dropdown>.text.divider{padding:0 4.285714rem;font-family:OpenSans-Medium;font-size:2.571429rem;line-height:6.428571rem;cursor:pointer;border:2px solid #000000;box-sizing:border-box;border-radius:1.714286rem;}&.disabled{background:#EEEEEE;border:unset !important;color:#AAAAAA;cursor:not-allowed;}&.ui.dropdown{.cru-fo{font-size:1.3rem;margin-left:1.1rem;}.menu::after{display:none;}.menu{width:100%;background:#FFFFFF;box-shadow:0 0.57rem 1.43rem 0 rgba(0,0,0,0.1);border:1px solid #EEEEEE;border-radius:0.86rem;padding:0.57rem;.icon{margin-left:1.144286rem;margin-right:1.714286rem;}.item{padding:0.78rem 0.57rem !important;border-radius:0.57rem;font-size:1.285714rem;&:active{background-color:#EEEEEE;}}}}"]))},529:function(e,t,n){n.d(t,{ZP:function(){return z}});var r=n(67294),i=n(1300),o=n(73716),a=n(65382),s=n(17082),c=n(96486),l=n.n(c);var u=n(30266),d=n(809),p=n.n(d),f=n(9669),m=n.n(f),h=n(93162),g=n(56755),v=n.n(g),x=n(28803),b=n(29163),w=n(12752),y=n(54040),k=n(65369),j=n(20478),C=n(59996),Z=n(56262),N=n(99056),E=n(23638),S=n(60954),F=n(85893);function I(e,t){var n=t.find((function(t){return t.value===e.UpEndpoint})),r=n&&n.value||t[0].value;return"".concat(r,"/ipfs/").concat(e.Hash,"?filename=").concat(e.Name)}function P(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={name:e.Name,encrypted:e.Encrypted,gateway:e.UpEndpoint,fromAccount:t.account,fromWallet:t.wallet,from:t.nickName,isDir:!!e.items};(0,C.H)({type:3,walletType:t.wallet,address:t.account,data:{cid:e.Hash,fileType:e.items?1:0,strategy:e.Encrypted?1:0,shareType:0}});var i=encodeURI(JSON.stringify(r));return n?"".concat(window.location.origin,"/files/receive?cid=").concat(e.Hash,"&options=").concat(i):"".concat(window.location.origin,"/files/share?cid=").concat(e.Hash,"&options=").concat(i)}var _=r.memo((0,b.ZP)((function(e){var t,n,o,s,c=e.file,d=e.className,f=e.uc,g=e.onDelete,b=e.type,C="public"===(void 0===b?"public":b),_=(0,j.V)(),A=(0,r.useContext)(w.Il),z=A.api,D=A.alert,T=A.loading,H=(0,Z.T)().endpoints,U=(0,r.useCallback)((0,u.Z)(p().mark((function e(){var t,n,r,i;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.Encrypted||0!==l().size(c.items)){e.next=28;break}if(e.prev=1,f.secret){e.next=4;break}return e.abrupt("return");case 4:return T.show(),e.next=7,m().get(I(c,H),{responseType:"arraybuffer"});case 7:return t=e.sent,console.info("res::",t),n=(new Date).getTime(),e.next=12,(0,y.n)(t.data,f.secret);case 12:if(r=e.sent,console.info("decrypt:",((new Date).getTime()-n)/1e3),r){e.next=16;break}throw"error";case 16:console.info("de:",r),i=new File([r],c.Name,{type:t.headers["content-type"]}),(0,h.saveAs)(i,c.Name),T.hide(),e.next=26;break;case 22:e.prev=22,e.t0=e.catch(1),T.hide(),D.error("Decrypt error");case 26:e.next=29;break;case 28:window.open(I(c,H),"_blank");case 29:case"end":return e.stop()}}),e,null,[[1,22]])}))),[f,c,H]),R=(0,E.WY)(),M=z&&(null===(t=z.query)||void 0===t?void 0:t.market)&&(null===(n=z.query)||void 0===n?void 0:n.market.files),L=!!M,O=(0,k.W7)(M,[c.Hash]),G=(0,k.W7)(null===z||void 0===z||null===(o=z.derive)||void 0===o||null===(s=o.chain)||void 0===s?void 0:s.bestNumber),W=G&&G.toNumber(),B=(0,r.useMemo)((function(){var e={status:"Submitted"};if(O&&!O.isEmpty){var t=function(e){try{return JSON.parse(JSON.stringify(e))}catch(t){return{expired_at:0,reported_replica_count:0,amount:0,file_size:0,prepaid:!1}}}(O),n=t.expired_at,r=t.reported_replica_count,i=t.amount,o=t.file_size,a=t.prepaid;e.expireTime=n,e.amount=i,e.startTime=n?n-216e3:0,e.fileSize=o,e.confirmedReplicas=r,e.prepaid=a,n&&n<W&&(e.status="Expired"),r<1&&(e.status="Submitted"),n&&n>W&&r>0&&(e.status="Success")}else L&&(new Date).getTime()-c.PinTime>=72e5&&(e.status="Failed");return W||(e.status="Loading"),e}),[O,W]);return(0,F.jsxs)(i.Z.Row,{className:d,children:[(0,F.jsxs)(i.Z.Cell,{className:"fileName",children:[(0,N.lS)(c.Name),c.items&&(0,F.jsx)("span",{className:"icon cru-fo-folder"}),c.Encrypted&&(0,F.jsx)(x.Z,{trigger:(0,F.jsx)("span",{className:"icon cru-fo-key"}),content:"Encrypted",position:"top center"})]}),(0,F.jsxs)(i.Z.Cell,{textAlign:"right",children:[(0,N.lS)(c.Hash),(0,F.jsx)(x.Z,{position:"top center",content:"Copy File CID",trigger:(0,F.jsx)("span",{className:"cru-fo cru-fo-copy",onClick:function(){return _(c.Hash)},style:{marginLeft:"1.8rem"}})})]}),(0,F.jsx)(i.Z.Cell,{textAlign:"center",style:{textTransform:"uppercase"},children:v()(Number(c.Size),{round:2})}),(0,F.jsxs)(i.Z.Cell,{textAlign:"center",children:["Loading"===B.status&&(0,F.jsx)(a.Z,{loading:!0,name:"spinner"}),"Submitted"===B.status&&B.status,"Expired"===B.status&&B.status,"Failed"===B.status&&B.status,"Success"===B.status&&"".concat(B.status," (").concat(B.confirmedReplicas," Replicas)")]}),(0,F.jsxs)(i.Z.Cell,{textAlign:"center",children:[(0,F.jsx)(x.Z,{position:"top center",content:"Open",trigger:(0,F.jsx)("span",{className:"cru-fo cru-fo-external-link",style:{marginLeft:"1rem"},onClick:U})}),(0,F.jsx)(x.Z,{position:"top center",content:"Delete",trigger:(0,F.jsx)("span",{className:"cru-fo cru-fo-trash-2",style:{marginLeft:"1rem"},onClick:function(){g(c)}})}),(0,F.jsx)(x.Z,{position:"top center",content:"IPFS Scan",trigger:(0,F.jsx)("span",{className:"cru-fo cru-fo-search",style:{marginLeft:"1rem"},onClick:function(){window.open("https://ipfs-scan.io?cid=".concat(c.Hash),"_blank")}})})]}),C&&(0,F.jsx)(i.Z.Cell,{textAlign:"center",children:(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(S.Z,{className:"item-share-btn",onClick:function(){window.open(P(c,R,!0),"_blank")},children:"Share"}),(0,F.jsx)(x.Z,{position:"top center",content:"Quick Tweet",trigger:(0,F.jsx)("span",{className:"cru-fo cru-fo-twitter",onClick:function(){var e=P(c,R,!0),t=R.nickName?"Check out what '".concat(R.nickName,"' is sharing on Crust Files!"):"Check out what I am sharing on Crust Files!",n="https://twitter.com/intent/tweet?text=".concat(encodeURI(t),"&url=").concat(encodeURIComponent(e),"&hashtags=web3,ipfs,crustnetwork,metaverse,crustfiles");window.open(n,"_blank")},style:{marginLeft:"0.5rem",top:"0.2rem"}})})]})})]})})).withConfig({displayName:"FileItem",componentId:"sc-3bbeav-0"})(["color:var(--secend-color) !important;.cru-fo,.icon{cursor:pointer;font-size:1.3rem;position:relative;top:0.3rem;}.fileName{.icon{margin-left:0.6rem;}}.item-share-btn{padding:5px 11px !important;border-radius:8px !important;}"])),A=n(11163);var z=r.memo((0,b.ZP)((function(e){var t=e.className,n=e.pageCount,c=void 0===n?7:n,u=e.files,d=e.type,p=void 0===d?"public":d,f=e.onDeleteItem,m=(0,A.useRouter)(),h="public"===p,g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=(0,r.useState)(1),i=n[0],o=n[1];return(0,r.useMemo)((function(){var n=l().chunk(e,t);return{totalPage:n.length,pageList:n[i-1]||[],setPage:o,page:i}}),[e,i])}((0,r.useMemo)((function(){return u.filter((function(e){return"public"===p?!e.Encrypted:e.Encrypted}))}),[u,p]),c),v=(0,s.MH)(),x=g.totalPage>1?2:5,b=h?x+1:x;return(0,F.jsxs)(i.Z,{basic:"very",className:t,children:[(0,F.jsx)(i.Z.Header,{className:"font-sans-semibold",children:(0,F.jsxs)(i.Z.Row,{children:[(0,F.jsx)(i.Z.HeaderCell,{children:"File Name"}),(0,F.jsx)(i.Z.HeaderCell,{width:"2",textAlign:"center",children:"File CID"}),(0,F.jsx)(i.Z.HeaderCell,{width:"2",textAlign:"center",children:"File Size"}),(0,F.jsx)(i.Z.HeaderCell,{width:"3",textAlign:"center",children:"Status"}),(0,F.jsx)(i.Z.HeaderCell,{width:"2",textAlign:"center",children:"Action"}),h&&(0,F.jsx)(i.Z.HeaderCell,{width:"2"})]})}),(0,F.jsx)(i.Z.Body,{className:"font-sans-regular",children:g.pageList.map((function(e,t){return(0,F.jsx)(_,{type:p,onDelete:f,uc:v,file:e},"files_item_".concat(t))}))}),(0,F.jsx)(i.Z.Footer,{children:(0,F.jsxs)(i.Z.Row,{children:[(0,F.jsx)(i.Z.HeaderCell,{colSpan:b,className:"btns",children:(0,F.jsxs)("div",{className:"files-tip",children:["The file list is locally cached. If you want to keep this list when switching to another device, please go to ",(0,F.jsx)("span",{onClick:function(){return m.push("/setting")},children:"Settings->User Data Management"})," to migrate your user data."]})}),g.totalPage>1&&(0,F.jsx)(i.Z.HeaderCell,{colSpan:"3",textAlign:"right",children:(0,F.jsx)(o.Z,{totalPages:g.totalPage,activePage:g.page,firstItem:null,lastItem:null,prevItem:{content:(0,F.jsx)(a.Z,{name:"angle left"}),icon:!0},nextItem:{content:(0,F.jsx)(a.Z,{name:"angle right"}),icon:!0},secondary:!0,onPageChange:function(e,t){var n=t.activePage;return g.setPage(n)}})})]})})]})})).withConfig({displayName:"FilesTable",componentId:"sc-dquu9o-0"})(["padding:1rem 2rem;width:100%;thead{font-size:1.29rem;font-weight:600;th:first-child{padding-left:0.57rem !important;}th{border-bottom:unset !important;}}tbody{color:var(--secend-color);tr,td{border-top:unset !important;}tr > td:first-child{padding-left:0.57rem !important;}tr:nth-child(2n - 1){background-color:#f8f8f8;td:first-child{overflow:hidden;border-top-left-radius:0.57rem;border-bottom-left-radius:0.57rem;}td:last-child{overflow:hidden;border-top-right-radius:0.57rem;border-bottom-right-radius:0.57rem;}}}tfoot{.btns > button{margin-right:1rem !important;}th{border-top:unset !important;}.btns{span{cursor:pointer;color:#808080;}}.btns > i{color:var(--secend-color);cursor:pointer;}.pagination > .item{color:var(--secend-color);padding:0.8rem 1rem !important;min-width:unset !important;border-radius:5rem !important;margin:unset;}.files-tip{font-size:13px;line-height:22px;color:#999999;padding-left:0.57rem;span{color:var(--primary-color);}}}"]))},99112:function(e,t,n){n.d(t,{Z:function(){return h}});var r=n(80318),i=n(67294),o=n(28803),a=n(29163),s=n(65058);var c=n(96486),l=n.n(c),u=n(94184),d=n.n(u),p=n(85893),f="_null",m=function(e){var t=e.expand,n=e.list,r=e.group,i=e.select,o=e.onClickItem,a=e.onClickGroup,s=e.renderGroupTitle,c=void 0===s?null:s,l=r===i.group;return(0,p.jsxs)("div",{className:"group",children:[r!==f&&(c&&c({group:r,select:i,onClickGroup:a})||(0,p.jsxs)("div",{className:d()("title",{active:l}),onClick:a,children:[r," ",(0,p.jsx)("span",{className:"dropIcon cru-fo-chevron-down"})]})),t&&n.map((function(e,t){return(0,p.jsx)("div",{className:d()("item",{active:l&&e.value===i.value}),onClick:function(t){return o(t,{group:r,value:e.value})},children:e.text},"group_item_".concat(t))}))]})};var h=i.memo((0,a.ZP)((function(e){var t,n=e.className,a=e.label,c=e.help,u=e.options,h=e.defaultValue,g=e.defaultGroup,v=void 0===g?f:g,x=e.renderGroupTitle,b=e.footer,w=(0,i.useState)({value:h,group:v}),y=w[0],k=w[1],j=(0,i.useMemo)((function(){return l().find(u,(function(e){return(e.group||f)===y.group&&e.value===y.value}))}),[u,y]),C=(0,i.useState)(v),Z=C[0],N=C[1],E=(0,s.O)(),S=(0,r.Z)(E,2),F=S[0],I=S[1],P=function(e){var t=(0,i.useRef)(null);return(0,i.useEffect)((function(){var n,r=function(n){t.current&&t.current!==n.target&&!t.current.contains(n.target)&&e&&e(n)};return null===(n=document)||void 0===n||n.addEventListener("mouseup",r),function(){var e;null===(e=document)||void 0===e||e.removeEventListener("mouseup",r)}}),[t.current]),t}((function(){F&&I(!1)})),_=(0,i.useMemo)((function(){return l().groupBy(u,(function(e){return e.group||f}))}),[u]),A=l().keys(_);return(0,p.jsxs)("div",{className:d()(n,"mdropdown"),onClick:function(){return I()},ref:P,children:[a&&(0,p.jsxs)("div",{className:"label font-sans-semibold",children:[a,c&&(0,p.jsx)(o.Z,{position:"top center",trigger:(0,p.jsx)("span",{className:"icon cru-fo-help-circle"}),content:c})]}),(0,p.jsx)("span",{className:d()("dropIcon","cru-fo-chevron-down")}),(0,p.jsx)("div",{className:"text font-sans-regular",children:null!==(t=null===j||void 0===j?void 0:j.text)&&void 0!==t?t:""}),F&&(0,p.jsxs)("div",{className:"options",children:[A.map((function(t,n){return(0,p.jsx)(m,{group:t,renderGroupTitle:x,select:y,expand:Z===t||t===f,list:_[t],onClickGroup:function(e){N(Z===t?f:t),e.stopPropagation()},onClickItem:function(t,n){k(n),e.onChange(t,n)}},"group_".concat(n))})),b]})]})})).withConfig({displayName:"MDropdown",componentId:"sc-1nmwkbf-0"})(["&.mdropdown{position:relative;width:100%;border-radius:0.57rem;border:1px solid var(--line-color);padding:0.8rem 1rem;cursor:pointer;.label{font-size:1rem;font-weight:600;white-space:nowrap;color:var(--main-color);margin-bottom:0.6rem;.icon{font-size:1.3rem;position:relative;top:0.2rem;margin-left:0.86rem;cursor:pointer;color:var(--secend-color);}}.dropIcon{float:right;position:relative;top:-0.9rem;right:0;}.text{font-size:1rem;color:#999999;}.options{width:100%;background:white;position:absolute;top:calc(100% + 1px);left:0;z-index:10;border-radius:4px;border:1px solid var(--line-color);box-shadow:0 1px 5px rgba(0,0,0,0.3);.group{.title{cursor:pointer;border-top:1px solid var(--line-color);padding:0.8rem 1rem;font-size:1.2rem;font-weight:500;&:hover,&.active{background:var(--line-color);}.dropIcon{float:right;right:0.6rem;top:0rem;}}.item{padding:0.6rem 1.6rem;cursor:pointer;&:hover,&.active{background:var(--line-color);}}}}}"]))},46176:function(e,t,n){n.d(t,{R:function(){return w}});var r=n(80318),i=n(30266),o=n(809),a=n.n(o),s=n(94184),c=n.n(s),l=n(67294),u=n(73935),d=n(29163),p=n(65058),f=n(85893);function m(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e,t){return new Promise((function(n){e.file((function(e){e._webkitRelativePath="".concat(t,"/").concat(e.name),n(e)}))}))}function v(e,t){return new Promise((function(n){var r=[];e.readEntries(function(){var o=(0,i.Z)(a().mark((function i(o){var s,c,l;return a().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!o.length){i.next=36;break}s=m(o),i.prev=3,s.s();case 5:if((c=s.n()).done){i.next=23;break}if(!(l=c.value).isFile){i.next=15;break}return i.t0=r,i.next=11,g(l,t);case 11:i.t1=i.sent,i.t0.push.call(i.t0,i.t1),i.next=21;break;case 15:if(!l.isDirectory){i.next=21;break}return i.t2=r,i.next=19,v(l.createReader(),"".concat(t,"/").concat(l.name));case 19:i.t3=i.sent,r=i.t2.concat.call(i.t2,i.t3);case 21:i.next=5;break;case 23:i.next=28;break;case 25:i.prev=25,i.t4=i.catch(3),s.e(i.t4);case 28:return i.prev=28,s.f(),i.finish(28);case 31:return i.t5=r,i.next=34,v(e,t);case 34:i.t6=i.sent,r=i.t5.concat.call(i.t5,i.t6);case 36:n(r);case 37:case"end":return i.stop()}}),i,null,[[3,25,28,31]])})));return function(e){return o.apply(this,arguments)}}())}))}function x(e){return b.apply(this,arguments)}function b(){return(b=(0,i.Z)(a().mark((function e(t){var n,r,i,o,s,c,l,u,d,p,f;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.files.length){e.next=2;break}return e.abrupt("return",null);case 2:for(n=t.items,r={files:[]},i=1===n.length,o=[],s=0;s<n.length;s++)c=n[s],(l=c.webkitGetAsEntry())&&l.isDirectory?(i&&(r.dir=l.name),o.push({reader:l.createReader(),path:l.name})):l&&(i?r.file=c.getAsFile():r.files.push(c.getAsFile()));u=0,d=o;case 8:if(!(u<d.length)){e.next=17;break}return p=d[u],e.next=12,v(p.reader,p.path);case 12:f=e.sent,r.files=r.files.concat(f);case 14:u++,e.next=8;break;case 17:return e.abrupt("return",r);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var w=l.memo((0,d.ZP)((function(e){var t=e.className,n=(0,p.O)(),o=(0,r.Z)(n,2),s=o[0],d=o[1],m=(0,l.useState)(null),h=m[0],g=m[1],v=function(){var t=(0,i.Z)(a().mark((function t(n){var r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.next=3,x(n.dataTransfer);case 3:r=t.sent,console.info("fielInfo:",r),d(!1),r&&e.onDrop&&e.onDrop(r);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return(0,l.useEffect)((function(){var e=document.getElementById("__next");g(e)}),[]),(0,l.useEffect)((function(){if(h){var e=function(e){e.preventDefault(),d(!0)},t=function(e){"_drap_drop_frame"===e.target.id&&d(!1)};return h.addEventListener("dragenter",e),h.addEventListener("dragleave",t),function(){var n=document.getElementById("_drap_drop_frame");n&&h.removeChild(n),h.removeEventListener("dragenter",e),h.removeEventListener("dragleave",t)}}}),[h]),h?u.createPortal((0,f.jsx)("div",{id:"_drap_drop_frame",onDrop:v,onDragOver:function(e){return e.preventDefault()},className:c()(t,{show:s}),children:"Upload files to this directory"}),h):null})).withConfig({displayName:"OnDrapDropFrame",componentId:"sc-oxlf0c-0"})(["position:fixed;width:100vw;height:100vh;z-index:9999999;left:0;top:0;background:rgba(255,255,255,0.7);border:3px dashed #CCCCCC;box-sizing:border-box;display:none;align-items:center;justify-content:center;font-weight:600;font-size:36px;&.show{display:flex;}"]))},86021:function(e,t,n){var r=n(80318),i=n(96486),o=n.n(i),a=n(67294),s=n(23499),c=n(345),l=n(73626),u=n(28258),d=n(37838),p=n(29163),f=n(65058),m=n(59996),h=n(56262),g=n(10416),v=n(60954),x=n(99112),b=n(85893),w=p.ZP.div.withConfig({displayName:"UploadModal__Contribute",componentId:"sc-1ozqz35-0"})(["cursor:pointer;height:40px;line-height:40px;color:var(--primary-color);text-align:center;"]),y=function(){};t.Z=a.memo((0,p.ZP)((function(e){var t=e.className,n=e.uc,i=e.file,p=e.onClose,k=void 0===p?y:p,j=e.onSuccess,C=void 0===j?y:j,Z=e.user,N=e.type,E=e.isPremium,S="vault"===N,F=(0,s.$)().t,I=(0,h.T)(),P=I.endpoint,_=I.endpoints,A=I.onChangeEndpoint,z=(0,h.q)(),D=z.onChangePinner,T=z.pinner,H=z.pins,U=S&&!!n.secret,R=(0,f.O)(),M=(0,r.Z)(R,2),L=M[0],O=M[1],G=(0,g.V)(Z,{isEncrypt:!!U,secret:n.secret,file:i,isPremium:E,endpoint:P,pinner:T}),W=G.error,B=G.cancelUp,q=G.upState,V=G.upload,J=G.isBusy,Y=G.fileSizeError,$=(0,a.useCallback)((function(){B&&B.cancel(),k()}),[B,k]),Q=Y||S&&!n.secret||!Z.account||!Z.sign;return(0,b.jsxs)(c.Z,{closeIcon:(0,b.jsx)("span",{className:"close icon cru-fo-x"}),onClose:$,open:!0,size:"large",className:t,children:[(0,b.jsx)(c.Z.Header,{className:"font-sans-semisold",children:F(i.dir?"Upload Folder":"Upload File")}),(0,b.jsxs)(c.Z.Content,{children:[(0,b.jsxs)(l.Z.Group,{children:[(0,b.jsx)(l.Z,{fluid:!0,children:(0,b.jsxs)(l.Z.Content,{children:[(0,b.jsx)(l.Z.Header,{content:i.dir?"Folder":"File"}),(0,b.jsx)(l.Z.Description,{content:i.dir?"".concat(i.dir," (").concat(i.files.length," files)"):"".concat(i.file.name," (").concat(i.file.size," bytes)")})]})}),L&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l.Z,{fluid:!0,children:(0,b.jsx)(x.Z,{fluid:!0,selection:!0,className:"clear-border",help:F("File streaming and wallet authentication will be processed by the chosen gateway."),disabled:J,label:F("Select a Web3 IPFS Gateway"),onChange:A,options:_,defaultGroup:P.group,defaultValue:P.value,footer:(0,b.jsx)(w,{onClick:function(){return window.open("https://wiki.crust.network/docs/en/buildIPFSWeb3AuthGW","_blank")},children:"Contribute IPFS W3Auth Gateway"})})}),(0,b.jsx)(l.Z,{fluid:!0,children:(0,b.jsx)(x.Z,{fluid:!0,selection:!0,className:"clear-border",help:F("Your file will be pinned to IPFS for long-term storage."),disabled:0===H.length,label:F("Select a Web3 IPFS Pinner"),onChange:D,options:H,defaultValue:T.value,footer:(0,b.jsx)(w,{onClick:function(){return window.open("https://wiki.crust.network/docs/en/buildIPFSW3AuthPin","_blank")},children:"Contribute IPFS W3Auth Pinner"})})})]}),i.file&&(0,b.jsx)(l.Z,{fluid:!0,className:"encryption",children:(0,b.jsxs)(l.Z.Content,{children:[(0,b.jsx)(l.Z.Header,{content:"File Encryption"}),n.secret?(0,b.jsx)(l.Z.Description,{content:U?"Yes":"File encryption is disabled in Public Mode."}):(0,b.jsx)(l.Z.Description,{content:"Please go to the 'Setting' page and set encryption key before activating this function."}),(0,b.jsx)(u.Z,{toggle:!0,defaultChecked:U,disabled:!0})]})}),!L&&(0,b.jsxs)("div",{className:"toggle-options",onClick:function(){return O()},children:[L?"Put Away":"More Settings",(0,b.jsx)("span",{className:"cru-fo cru-fo-chevron-down"})]})]}),W&&(0,b.jsx)("div",{style:{color:"orangered",padding:"1rem",whiteSpace:"pre-wrap",wordBreak:"break-all"},children:W})]}),(0,b.jsx)(c.Z.Actions,{children:(0,b.jsxs)("div",{className:"uploading",children:[q.up&&(0,b.jsx)(d.Z,{value:q.progress,total:100,active:!0,color:"orange"}),q.up&&(0,b.jsx)(v.Z,{onClick:$,children:F("Cancel")}),!q.up&&(0,b.jsx)(v.Z,{fluid:!0,onClick:function(){Q||V().then((function(e){var t=(0,r.Z)(e,1)[0];return C(t),(0,m.H)({type:2,walletType:Z.wallet,address:Z.account,data:{cid:t.Hash,fileType:o().size(t.items)?1:0,strategy:t.Encrypted?1:0}})})).catch(console.error)},disabled:Q,children:F("Sign and Upload")})]})})]})})).withConfig({displayName:"UploadModal",componentId:"sc-1ozqz35-1"})(['width:51.43rem !important;.header:nth-child(2){height:3.93rem;font-size:1.3rem !important;padding:0 1.14rem !important;font-weight:600 !important;line-height:3.93rem !important;}.close.icon{top:0.5rem;right:0.6rem;color:#666666;}.content{padding:1rem !important;}.ui.cards > .card{margin:0.5rem !important;.content > .header{font-size:1rem;font-weight:unset !important;color:var(--main-color);font-weight:600;font-family:OpenSans-SemiBold;}.content > .description{font-size:1rem;color:#999999;font-family:OpenSans-Regular;}}.ui.cards > .card:first-child{margin-top:1rem !important;}.toggle-options{cursor:pointer;font-size:10px;color:#999999;line-height:14px;margin-top:8px;margin-left:1.51rem;.cru-fo{font-size:14px;position:relative;top:2px;margin-left:6px;}}.actions{height:4.8rem;padding:0.5rem 1rem 0 1rem !important;border-top:unset !important;background:unset !important;.button{margin-left:unset !important;}}.uploading{height:4rem;display:flex;align-items:center;.progress{margin:0 1rem 0 0 !important;vertical-align:baseline;background:unset !important;border:1px solid orange;flex:1;.bar{min-width:unset !important;height:2.5rem;}}}.card.encryption{position:relative;.toggle{position:absolute;top:calc(50% - 0.75rem);right:1rem;input[type="radio"]:checked + label:before{background-color:#2ED158 !important;}}}']))},65369:function(e,t,n){n.d(t,{W7:function(){return u}});var r=n(80318),i=n(83789),o=n(67294),a=n(66103),s=n(98278);function c(e){return e}function l(e){e.current.isActive=!1,e.current.subscriber&&(e.current.subscriber.then((function(e){return e()})).catch(console.error),e.current.subscriber=null)}function u(e,t,n){var u=function(){var e=(0,o.useRef)(!1);return(0,o.useEffect)((function(){return e.current=!0,function(){e.current=!1}}),[]),e}(),d=(0,o.useRef)({isActive:!1,serialized:null,subscriber:null}),p=(0,o.useState)((n||{}).defaultValue),f=p[0],m=p[1];return(0,o.useEffect)((function(){return function(){return l(d)}}),[]),(0,o.useEffect)((function(){if(u.current&&e){var o=function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).paramMap,r=void 0===n?c:n;return[JSON.stringify({f:null===e||void 0===e?void 0:e.name,p:t}),0!==t.length&&t.some((function(e){return(0,a.F)(e)||(0,s.o)(e)}))?null:r(t)]}(e,t||[],n),p=(0,r.Z)(o,2),f=p[0],h=p[1];h&&f!==d.current.serialized&&(d.current.serialized=f,function(e,t,n,r,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},u=a.transform,d=void 0===u?c:u,p=a.withParams,f=a.withParamsTransform,m=r.filter((function(e){return!(0,s.o)(e)}));l(t),setTimeout((function(){var a;e.current&&(!n||n.meta&&null!==(a=n.meta.type)&&void 0!==a&&a.isDoubleMap&&2!==m.length?t.current.subscriber=null:(t.current.isActive=!0,t.current.subscriber=n.apply(void 0,(0,i.Z)(r).concat([function(n){e.current&&t.current.isActive&&e.current&&t.current.isActive&&o(p?[r,d(n)]:d(f?[r,n]:n))}]))))}),0)}(u,d,e,h,m,n))}}),[e,n,u,t]),f}},55867:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(80318),i=n(67294),o=n(23499),a=n(12752);function s(){var e=(0,o.$)().t,t=(0,i.useContext)(a.Il).alert,n=(0,i.useState)(void 0),s=n[0],c=n[1],l=(0,i.useRef)(null),u=(0,i.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];l.current&&(l.current.webkitdirectory=e,l.current.multiple=e,l.current.click())}),[l]),d=(0,i.useCallback)((function(){return u(!1)}),[u]),p=(0,i.useCallback)((function(){return u(!0)}),[u]),f=(0,i.useCallback)((function(n){var i=n.target.files;if(i)if(i.length>2e3)t.alert({title:e("Upload"),msg:e("Please do not upload more than 2000 files"),type:"error"});else if(0!==i.length){if(n.target.webkitdirectory){if(i.length>=1){for(var o=[],a=0;a<i.length;a++)o.push(i[a]);console.info(o);var s=o[0].webkitRelativePath.split("/"),l=(0,r.Z)(s,1)[0];c({files:o,dir:l})}}else c({file:i[0]});n.target.value=""}else t.alert({title:e("Upload"),msg:e("Please select non-empty folder"),type:"error"})}),[c,t,e]);return(0,i.useMemo)((function(){return{file:s,setFile:c,inputRef:l,_onClickUpFile:d,_onClickUpFolder:p,_onInputFile:f}}),[s,l,d,p,f])}}}]);