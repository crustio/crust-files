"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[17],{54040:function(e,t,n){n.d(t,{P:function(){return i},n:function(){return s}});var r=n(30266),o=n(809),a=n.n(o),u=function(){var e=(0,r.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.crypto.subtle.importKey("raw",t,"PBKDF2",!1,["deriveKey"]));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=(0,r.Z)(a().mark((function e(t,n,r){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.crypto.subtle.deriveKey(r,t,{name:"AES-GCM",length:256},!1,n));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),i=function(){var e=(0,r.Z)(a().mark((function e(t,n){var r,o,i,s,f,l,p,y,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=new Uint8Array(t),o=(new TextEncoder).encode(n),i=window.crypto.getRandomValues(new Uint8Array(16)),s=window.crypto.getRandomValues(new Uint8Array(12)),e.next=7,u(o);case 7:return f=e.sent,e.next=10,c(f,["encrypt"],{name:"PBKDF2",salt:i,iterations:25e4,hash:"SHA-256"});case 10:return l=e.sent,e.next=13,window.crypto.subtle.encrypt({name:"AES-GCM",iv:s},l,r);case 13:return p=e.sent,y=new Uint8Array(p),(d=new Uint8Array(y.byteLength+i.byteLength+s.byteLength)).set(i,0),d.set(s,i.byteLength),d.set(y,i.byteLength+s.byteLength),e.abrupt("return",d);case 22:throw e.prev=22,e.t0=e.catch(0),console.error("Error encrypting file"),console.error(e.t0),e.t0;case 27:case"end":return e.stop()}}),e,null,[[0,22]])})));return function(t,n){return e.apply(this,arguments)}}(),s=function(){var e=(0,r.Z)(a().mark((function e(t,n){var r,o,i,s,f,l,p,y;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=new Uint8Array(t),o=(new TextEncoder).encode(n),i=r.slice(0,16),s=r.slice(16,28),f=r.slice(28),e.next=8,u(o);case 8:return l=e.sent,e.next=11,c(l,["decrypt"],{name:"PBKDF2",salt:i,iterations:25e4,hash:"SHA-256"});case 11:return p=e.sent,e.next=14,window.crypto.subtle.decrypt({name:"AES-GCM",iv:s},p,f);case 14:return y=e.sent,e.abrupt("return",y);case 18:return e.prev=18,e.t0=e.catch(0),console.error("Error decrypting file"),console.error(e.t0),e.abrupt("return");case 23:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t,n){return e.apply(this,arguments)}}()},17082:function(e,t,n){n.d(t,{vZ:function(){return b},hC:function(){return w},MH:function(){return h}});var r=n(92809),o=n(30266),a=n(80318),u=n(809),c=n.n(u),i=n(67294),s=n(58971),f=n.n(s),l=n(65058);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d=n(21994).Cypher,v=new d(8),b=function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(){r.result&&t(r.result)},r.onerror=n,r.readAsArrayBuffer(e)}))};function w(e){try{var t=e&&e.trim();if(t){var n=t.split(" ");if(1===n.length&&n[0]){var r=n[0],o=window.atob(r),a=v.phraseFromSecret(o);if(a&&a.split(" ").length>=4)return{secret:r,seeds:a}}else if(n.length>=4){var u=v.secretFromPhrase(t);if(u&&u.split("-").length>=4)return{secret:window.btoa(u),seeds:t}}}return null}catch(c){return null}}function h(){var e=(0,i.useState)({}),t=e[0],n=e[1],r=(0,l.O)(),u=(0,a.Z)(r,2),s=u[0],p=u[1];(0,i.useEffect)((function(){var e=f().get("user:crypto");e&&n(e),p(!0)}),[]);var v=(0,i.useCallback)((function(e){n(e),f().set("user:crypto",e)}),[]),b=(0,i.useCallback)((0,o.Z)(c().mark((function e(){var t,n,r,o,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new d(8),n=t.genMnemonics(),r=n.secret,o=n.mnemonics,a={secret:window.btoa(r),seeds:o},v(a),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)}))),[]);return(0,i.useMemo)((function(){return y(y({},t),{},{generate:b,set:v,init:s})}),[t,v,s,b])}},56262:function(e,t,n){n.d(t,{T:function(){return l},q:function(){return p}});var r=n(92809),o=n(67294),a=n(75282),u=n(23499),c=n(58971),i=n.n(c);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"upload:last-gateway",t=(0,u.$)(),n=t.t,r=(0,o.useMemo)((function(){return(0,a.Dl)(n).map((function(e){var t,n;return f(f({},e),{},{text:"".concat(null!==(t=e.text)&&void 0!==t?t:""," (").concat(null!==(n=e.location)&&void 0!==n?n:"",")")})}))}),[n]),c=(0,o.useMemo)((function(){var t=i().get(e);if(t){var n=r.findIndex((function(e){return e.value===t.value}));if(n>=0)return n}return 0}),[e,r]),s=(0,o.useState)(r[c]),l=s[0],p=s[1],y=(0,o.useCallback)((function(t){p((function(n){var r="function"===typeof t?t(n):t;return i().set(e,{value:r.value}),r}))}),[]),d=(0,o.useCallback)((function(e,t){var n=t.value,o=r.find((function(e){return e.value===n}));o&&y(o)}),[r,y]);return(0,o.useMemo)((function(){return{endpoints:r,endpoint:l,setEndpoint:y,onChangeEndpoint:d}}),[r,l,y,d])}function p(){var e=(0,u.$)().t,t=(0,o.useMemo)((function(){return(0,a.qi)(e).sort((function(){return Math.random()>.5?-1:1})).map((function(e){var t;return f(f({},e),{},{text:"".concat(null!==(t=e.text)&&void 0!==t?t:"Pinner")})}))}),[e]),n=(0,o.useState)(t[0]),r=n[0],c=n[1],i=(0,o.useCallback)((function(e,n){var r=n.value,o=t.find((function(e){return e.value===r}));o&&c(o)}),[t]);return(0,o.useMemo)((function(){return{pinner:r,pins:t,setPinner:c,onChangePinner:i}}),[r,t,i])}},10416:function(e,t,n){n.d(t,{V:function(){return h}});var r=n(92809),o=n(30266),a=n(809),u=n.n(a),c=n(9669),i=n.n(c),s=n(67294),f=n(54040),l=n(17082),p=n(23638);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){c=!0,a=e},f:function(){try{u||null==n.return||n.return()}finally{if(c)throw a}}}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=1048576;function h(e,t){var n=(0,s.useState)(),r=n[0],a=n[1],c=(0,s.useState)({progress:0,up:!1}),y=c[0],b=c[1],h=(0,s.useState)(null),m=h[0],g=h[1],O=(0,s.useState)(!1),P=O[0],j=O[1],x=t.isEncrypt,k=void 0!==x&&x,S=t.secret,E=t.file,A=t.isPremium,D=void 0!==A&&A,C=t.endpoint,M=t.pinner,T=(0,s.useMemo)((function(){return D?1024:40}),[D]),Z=(0,s.useMemo)((function(){if(!E)return!1;if(E.file)return E.file.size>T*w;if(E.files){var e,t=0,n=v(E.files);try{for(n.s();!(e=n.n()).done;){t+=e.value.size}}catch(r){n.e(r)}finally{n.f()}return t>T*w}return!1}),[E,T]);return{upload:function(){var t=(0,o.Z)(u().mark((function t(n){var r,o,c,s,y,w,h,m,O,P,x,A,D,Z,B,U,F,K,L,R,z,N,_,q,G,H,I,V,$,J,W,Q;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a(""),j(!0),r=(0,p.WJ)(e),o="near"===e.wallet?e.pubKey||"":e.account,t.next=7,e.sign(o,e.account);case 7:if(c=t.sent,s="elrond"===e.wallet?c:"".concat(r,"-").concat(o,":").concat(c),y=window.btoa(s),w="Basic ".concat(y),h="Bearer ".concat(y),m=i().CancelToken.source(),g(m),b({progress:0,up:!0}),O=new FormData,P=n||E,!k){t.next=58;break}if(!P.file){t.next=32;break}return x=(new Date).getTime(),t.next=22,(0,l.vZ)(P.file);case 22:return A=t.sent,console.info("readFile::",((new Date).getTime()-x)/1e3),t.next=26,(0,f.P)(A,S);case 26:D=t.sent,console.info("encrypted::",((new Date).getTime()-x)/1e3),Z=new Blob([D],{type:P.file.type}),O.append("file",Z,P.file.name),t.next=56;break;case 32:if(!P.files){t.next=56;break}B=v(P.files),t.prev=34,B.s();case 36:if((U=B.n()).done){t.next=48;break}return F=U.value,t.next=40,(0,l.vZ)(F);case 40:return K=t.sent,t.next=43,(0,f.P)(K,S);case 43:L=t.sent,R=new Blob([L],{type:F.type}),O.append("file",R,F.webkitRelativePath);case 46:t.next=36;break;case 48:t.next=53;break;case 50:t.prev=50,t.t0=t.catch(34),B.e(t.t0);case 53:return t.prev=53,B.f(),t.finish(53);case 56:t.next=59;break;case 58:if(P.file)O.append("file",P.file,P.file.name);else if(P.files){z=v(P.files);try{for(z.s();!(N=z.n()).done;)_=N.value,O.append("file",_,_._webkitRelativePath||_.webkitRelativePath)}catch(u){z.e(u)}finally{z.f()}}case 59:return q=C.value,t.next=62,i().request({cancelToken:m.token,data:O,headers:{Authorization:w},maxContentLength:T,method:"POST",onUploadProgress:function(e){var t=e.loaded/e.total;b({progress:Math.round(99*t),up:!0})},params:{pin:!0},url:"".concat(q,"/api/v0/add")});case 62:return"string"===typeof(G=t.sent).data?(I=G.data.replaceAll("}\n{","},{"),V=JSON.parse("[".concat(I,"]")),$=V.length-1,H=V[$],delete V[$],H.items=V):H=G.data,console.info("upResult:",G),g(null),b({progress:99,up:!0}),J=M.value,t.next=70,i().request({data:{cid:H.Hash,name:H.Name},headers:{Authorization:h},method:"POST",url:"".concat(J,"/psa/pins")});case 70:return b({progress:100,up:!1}),W=d(d({},H),{},{PinEndpoint:J,PinTime:(new Date).getTime(),UpEndpoint:q,Encrypted:k}),Q={msg:o,signature:c},t.abrupt("return",[W,Q]);case 76:throw t.prev=76,t.t1=t.catch(0),b({progress:0,up:!1}),j(!1),console.error(t.t1),a("Network Error,Please try to switch a Gateway."),t.t1;case 83:case"end":return t.stop()}}),t,null,[[0,76],[34,50,53,56]])})));return function(e){return t.apply(this,arguments)}}(),error:Z?"Do not upload files larger than ".concat(T,"MB!"):r,isBusy:P,upState:y,cancelUp:m,fileSizeError:Z}}}}]);