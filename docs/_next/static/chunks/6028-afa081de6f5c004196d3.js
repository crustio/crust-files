"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6028],{66028:function(e,t,r){r.d(t,{N:function(){return T}});var n=r(30266),s=r(809),i=r.n(s),a=r(6169),c=r(9669),o=r.n(c),u=r(93162),p=r(56755),l=r.n(p),f=r(96486),m=r.n(f),d=r(67294),h=r(1300),v=r(22090),g=r(65382),x=r(29163),w=r(12752),b=r(54040),y=r(65369),k=r(20478),j=r(81496),N=r(59996),C=r(45129),Z=r(56262),S=r(99056),O=r(57908),_=r(60954),E=r(85893),T=["https://crustipfs.live","https://crustipfs.art","https://crustipfs.info","https://web3files.world","https://web3files.live","https://storagefiles.site","https://storagefiles.space","https://crustipfs.tech"];function z(e,t,r){return"".concat(r,"/ipfs/").concat(e.Hash,"?filename=").concat(e.Name)}function D(e,t){return P.apply(this,arguments)}function P(){return(P=(0,n.Z)(i().mark((function e(t,r){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,C.Cn)(t.Hash,{name:t.Name,encrypted:t.Encrypted,gateway:t.UpEndpoint,fromAccount:r.account,fromWallet:r.wallet,from:r.nickName,isDir:!!t.items});case 2:return n=e.sent,(0,N.H)({type:3,walletType:r.wallet,address:r.account,data:{cid:t.Hash,fileType:t.items?1:0,strategy:t.Encrypted?1:0,shareType:0}}),e.abrupt("return","".concat(window.location.origin,"/share?code=").concat(n));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e){try{return JSON.parse(JSON.stringify(e))}catch(t){return{expired_at:0,reported_replica_count:0,amount:0,file_size:0,prepaid:!1}}}t.Z=d.memo((0,x.ZP)((function(e){var t,r,s,c,p=e.file,f=e.className,x=e.uc,N=e.onDelete,C=e.type,T="public"===(void 0===C?"public":C),P=(0,k.V)(),F=(0,d.useContext)(w.Il),H=F.api,R=F.alert,I=F.loading,L=(0,Z.T)().endpoints,q=(0,j.z)().gateway,W=(0,d.useCallback)((0,n.Z)(i().mark((function e(){var t,r,n,s,a,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!p.Encrypted||0!==m().size(p.items)){e.next=29;break}if(e.prev=1,x.secret){e.next=4;break}return e.abrupt("return");case 4:return I.show(),t=z(p,0,q),e.next=8,o().get(t,{responseType:"arraybuffer"});case 8:return r=e.sent,console.info("res::",r),n=(new Date).getTime(),e.next=13,(0,b.n)(r.data,x.secret);case 13:if(s=e.sent,console.info("decrypt:",((new Date).getTime()-n)/1e3),s){e.next=17;break}throw"error";case 17:console.info("de:",s),a=new File([s],p.Name,{type:r.headers["content-type"]}),(0,u.saveAs)(a,p.Name),I.hide(),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(1),I.hide(),R.error("Decrypt error");case 27:e.next=31;break;case 29:c=z(p,0,q),window.open(c,"_blank");case 31:case"end":return e.stop()}}),e,null,[[1,23]])}))),[x,p,L,q]),M=(0,O.WY)(),V=function(){var e=(0,n.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D(p,M);case 3:t=e.sent,window.open(t,"_blank"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),R.error((0,S.az)(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=(0,n.Z)(i().mark((function e(){var t,r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D(p,M);case 3:t=e.sent,r=M.nickName?"Check out what '".concat(M.nickName,"' is sharing on Crust Files!"):"Check out what I am sharing on Crust Files!",n="https://twitter.com/intent/tweet?text=".concat(encodeURI(r),"&url=").concat(encodeURIComponent(t),"&hashtags=web3,ipfs,crustnetwork,metaverse,crustfiles"),window.open(n,"_blank"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),R.error((0,S.az)(e.t0));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),U=H&&(null===(t=H.query)||void 0===t?void 0:t.market)&&((0,a.m)(H.query.market.filesV2)?H.query.market.filesV2:H.query.market.files),Q=H&&(null===(r=H.query)||void 0===r?void 0:r.market)&&H.query.market.files,Y=!!U,B=(0,y.W7)(U,[p.Hash]),G=(0,y.W7)(Q,[p.Hash]),K=(0,y.W7)(null===H||void 0===H||null===(s=H.derive)||void 0===s||null===(c=s.chain)||void 0===c?void 0:c.bestNumber),X=K&&K.toNumber(),$=(0,d.useMemo)((function(){var e={status:"Submitted"};if(G&&!G.isEmpty){var t=A(G),r=t.expired_at,n=t.reported_replica_count,s=t.amount,i=t.file_size,a=t.prepaid;e.expireTime=r,e.amount=s,e.startTime=r?r-216e3:0,e.fileSize=i,e.confirmedReplicas=n,e.prepaid=a,r&&r<X&&(e.status="Expired"),n<1&&(e.status="Submitted"),r&&r>X&&n>0&&(e.status="Success")}else if(B&&!B.isEmpty){var c=A(B),o=c.expired_at,u=c.reported_replica_count,l=c.amount,f=c.file_size,m=c.prepaid;e.expireTime=o,e.amount=l,e.startTime=o?o-216e3:0,e.fileSize=f,e.confirmedReplicas=u,e.prepaid=m,o&&o<X&&(e.status="Expired"),u<1&&(e.status="Submitted"),o&&o>X&&u>0&&(e.status="Success")}else Y&&(new Date).getTime()-p.PinTime>=72e5&&(e.status="Failed");return X||(e.status="Loading"),e}),[G,B,X]);return(0,E.jsxs)(h.Z.Row,{className:f,children:[(0,E.jsxs)(h.Z.Cell,{className:"fileName",children:[(0,S.lS)(p.Name),p.items&&(0,E.jsx)("span",{className:"icon cru-fo-folder"}),p.Encrypted&&(0,E.jsx)(v.Z,{trigger:(0,E.jsx)("span",{className:"icon cru-fo-key"}),content:"Encrypted",position:"top center"})]}),(0,E.jsxs)(h.Z.Cell,{textAlign:"right",children:[(0,S.lS)(p.Hash),(0,E.jsx)(v.Z,{position:"top center",content:"Copy File CID",trigger:(0,E.jsx)("span",{className:"cru-fo cru-fo-copy",onClick:function(){return P(p.Hash)},style:{marginLeft:"1.8rem"}})})]}),(0,E.jsx)(h.Z.Cell,{textAlign:"center",style:{textTransform:"uppercase"},children:l()(Number(p.Size),{round:2})}),(0,E.jsxs)(h.Z.Cell,{textAlign:"center",children:["Loading"===$.status&&(0,E.jsx)(g.Z,{loading:!0,name:"spinner"}),"Submitted"===$.status&&$.status,"Expired"===$.status&&$.status,"Failed"===$.status&&$.status,"Success"===$.status&&"".concat($.status," (").concat($.confirmedReplicas," Replicas)")]}),(0,E.jsxs)(h.Z.Cell,{textAlign:"center",children:[(0,E.jsx)(v.Z,{position:"top center",content:"Open",trigger:(0,E.jsx)("span",{className:"cru-fo cru-fo-external-link",style:{marginLeft:"1rem"},onClick:W})}),(0,E.jsx)(v.Z,{position:"top center",content:"Delete",trigger:(0,E.jsx)("span",{className:"cru-fo cru-fo-trash-2",style:{marginLeft:"1rem"},onClick:function(){N(p)}})}),(0,E.jsx)(v.Z,{position:"top center",content:"IPFS Scan",trigger:(0,E.jsx)("span",{className:"cru-fo cru-fo-search",style:{marginLeft:"1rem"},onClick:function(){window.open("https://ipfs-scan.io?cid=".concat(p.Hash),"_blank")}})})]}),T&&(0,E.jsx)(h.Z.Cell,{textAlign:"center",children:(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(_.Z,{className:"item-share-btn",onClick:V,children:"Share"}),(0,E.jsx)(v.Z,{position:"top center",content:"Quick Tweet",trigger:(0,E.jsx)("span",{className:"cru-fo cru-fo-twitter",onClick:J,style:{marginLeft:"0.5rem",top:"0.2rem"}})})]})})]})})).withConfig({displayName:"FileItem",componentId:"sc-3bbeav-0"})(["color:var(--secend-color) !important;.cru-fo,.icon{cursor:pointer;font-size:1.3rem;position:relative;top:0.3rem;}.fileName{.icon{margin-left:0.6rem;}}.item-share-btn{padding:5px 11px !important;border-radius:8px !important;}"]))},65369:function(e,t,r){r.d(t,{W7:function(){return p}});var n=r(80318),s=r(83789),i=r(67294),a=r(66103),c=r(98278);function o(e){return e}function u(e){e.current.isActive=!1,e.current.subscriber&&(e.current.subscriber.then((function(e){return e()})).catch(console.error),e.current.subscriber=null)}function p(e,t,r){var p=function(){var e=(0,i.useRef)(!1);return(0,i.useEffect)((function(){return e.current=!0,function(){e.current=!1}}),[]),e}(),l=(0,i.useRef)({isActive:!1,serialized:null,subscriber:null}),f=(0,i.useState)((r||{}).defaultValue),m=f[0],d=f[1];return(0,i.useEffect)((function(){return function(){return u(l)}}),[]),(0,i.useEffect)((function(){if(p.current&&e){var i=function(e,t){var r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).paramMap,n=void 0===r?o:r;return[JSON.stringify({f:null===e||void 0===e?void 0:e.name,p:t}),0!==t.length&&t.some((function(e){return(0,a.F)(e)||(0,c.o)(e)}))?null:n(t)]}(e,t||[],r),f=(0,n.Z)(i,2),m=f[0],h=f[1];h&&m!==l.current.serialized&&(l.current.serialized=m,function(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},p=a.transform,l=void 0===p?o:p,f=a.withParams,m=a.withParamsTransform,d=n.filter((function(e){return!(0,c.o)(e)}));u(t),setTimeout((function(){var a;e.current&&(!r||r.meta&&null!==(a=r.meta.type)&&void 0!==a&&a.isDoubleMap&&2!==d.length?t.current.subscriber=null:(t.current.isActive=!0,t.current.subscriber=r.apply(void 0,(0,s.Z)(n).concat([function(r){e.current&&t.current.isActive&&e.current&&t.current.isActive&&i(f?[n,l(r)]:l(m?[n,r]:r))}]))))}),0)}(p,l,e,h,d,r))}}),[e,r,p,t]),m}},81496:function(e,t,r){r.d(t,{N:function(){return u},z:function(){return p}});var n=r(92809),s=r(67294),i=r(58971),a=r.n(i);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u=[{text:"https://ipfs.io",value:"https://ipfs.io"},{text:"https://crustipfs.mobi",value:"https://crustipfs.mobi"},{text:"https://crust.fans",value:"https://crust.fans"},{text:"https://crustipfs.world",value:"https://crustipfs.world"},{text:"https://crustgateway.online",value:"https://crustgateway.online"},{text:"https://crustipfs.info",value:"https://crustipfs.info"},{text:"https://gw.w3ipfs.org.cn",value:"https://gw.w3ipfs.org.cn"},{text:"https://crustipfs.art",value:"https://crustipfs.art"}];function p(){var e=(0,s.useState)({gateway:"https://ipfs.io"}),t=e[0],r=e[1];(0,s.useEffect)((function(){var e=a().get("downloadgateway");e&&r(e)}),[]);var n=(0,s.useCallback)((function(e){var t={gateway:e};r(t),a().set("downloadgateway",t)}),[]);return(0,s.useMemo)((function(){return o(o({},t),{},{set:n})}),[t,n])}}}]);