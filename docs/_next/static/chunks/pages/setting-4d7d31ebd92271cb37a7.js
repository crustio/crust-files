(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[552],{17082:function(e,r,t){"use strict";t.d(r,{vZ:function(){return g},hC:function(){return b},MH:function(){return y}});var n=t(92809),s=t(30266),o=t(80318),i=t(809),a=t.n(i),c=t(67294),l=t(58971),u=t.n(l),f=t(65058);function d(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function m(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?d(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var p=t(21994).Cypher,h=new p(8),g=function(e){return new Promise((function(r,t){var n=new FileReader;n.onload=function(){n.result&&r(n.result)},n.onerror=t,n.readAsArrayBuffer(e)}))};function b(e){try{var r=e&&e.trim();if(r){var t=r.split(" ");if(1===t.length&&t[0]){var n=t[0],s=window.atob(n),o=h.phraseFromSecret(s);if(o&&o.split(" ").length>=4)return{secret:n,seeds:o}}else if(t.length>=4){var i=h.secretFromPhrase(r);if(i&&i.split("-").length>=4)return{secret:window.btoa(i),seeds:r}}}return null}catch(a){return null}}function y(){var e=(0,c.useState)({}),r=e[0],t=e[1],n=(0,f.O)(),i=(0,o.Z)(n,2),l=i[0],d=i[1];(0,c.useEffect)((function(){var e=u().get("user:crypto");e&&t(e),d(!0)}),[]);var h=(0,c.useCallback)((function(e){t(e),u().set("user:crypto",e)}),[]),g=(0,c.useCallback)((0,s.Z)(a().mark((function e(){var r,t,n,s,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new p(8),t=r.genMnemonics(),n=t.secret,s=t.mnemonics,o={secret:window.btoa(n),seeds:s},h(o),e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)}))),[]);return(0,c.useMemo)((function(){return m(m({},r),{},{generate:g,set:h,init:l})}),[r,h,l,g])}},8130:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return U}});var n=t(83789),s=t(80318),o=t(94184),i=t.n(o),a=t(93162),c=t.n(a),l=t(11163),u=t(67294),f=t(23499),d=t(35766),m=t(21004),p=t(49147),h=t(27416),g=t(29163),b=t(60954),y=t(92809),v=t(10219),x=t(345),j=t(60416),w=t(17082),O=t(85893),N=["alert","onSuccess","toggleOpen"];function C(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function k(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?C(Object(t),!0).forEach((function(r){(0,y.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):C(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var P=u.memo((0,g.ZP)((function(e){var r=e.alert,t=e.onSuccess,n=e.toggleOpen,s=(0,v.Z)(e,N),o=(0,u.useState)(""),i=o[0],a=o[1],c=(0,u.useCallback)((function(e,r){var t=r.value;a(t)}),[]),l=(0,u.useCallback)((function(){var e=(0,w.hC)(i);e?(t(e),n(!1)):r.error("Please check input value")}),[i,r]),f=(0,u.useCallback)((function(){a(""),n(!1)}),[]);return(0,O.jsxs)(x.Z,k(k({closeIcon:(0,O.jsx)("span",{className:"close icon cru-fo-x"}),onClose:f},s),{},{children:[(0,O.jsx)(x.Z.Header,{content:"Input a new key"}),(0,O.jsxs)(x.Z.Content,{children:[(0,O.jsx)(j.Z,{fluid:!0,onChange:c}),(0,O.jsxs)("div",{className:"btns",children:[(0,O.jsx)(b.Z,{content:"Input",onClick:l}),(0,O.jsx)(b.Z,{content:"Cancel",onClick:function(){return n(!1)}})]})]})]}))})).withConfig({displayName:"ModalNewKey",componentId:"sc-1ramix5-0"})(["width:34.3rem !important;.header{height:3.93rem;font-size:1.3rem !important;padding:0 1.14rem !important;font-weight:600 !important;line-height:3.93rem !important;}.close.icon{top:0.5rem;right:0.6rem;color:#666666;}.content{padding:1rem !important;input{border:0.07rem solid #CCCCCC !important;border-radius:0.57rem !important;}.btns{padding-top:2.3rem;button{width:calc(50% - 0.5rem) !important;margin:unset;}button:first-child{margin-right:1rem;}}}"])),E=t(86316),Z=t(12752),S=t(20478),I=t(13711),A=t(65058),F=t(96705);function _(e,r){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,r){if(!e)return;if("string"===typeof e)return D(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return D(e,r)}(e))||r&&e&&"number"===typeof e.length){t&&(e=t);var n=0,s=function(){};return{s:s,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){function r(r){return e.apply(this,arguments)}return r.toString=function(){return e.toString()},r}((function(e){throw e})),f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){function r(r){return e.apply(this,arguments)}return r.toString=function(){return e.toString()},r}((function(e){a=!0,o=e})),f:function(){try{i||null==t.return||t.return()}finally{if(a)throw o}}}}function D(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var U=u.memo((0,g.ZP)((function(e){var r=e.className,t=(0,f.$)().t,o=(0,w.MH)(),a=(0,l.useRouter)(),g=(0,u.useContext)(Z.Il).alert,y=(0,A.O)(!1),v=(0,s.Z)(y,2),x=v[0],j=v[1],N=(0,A.O)(),C=(0,s.Z)(N,2),k=C[0],D=C[1];(0,u.useEffect)((function(){o.init&&!o.secret&&D(!0)}),[o]);var U=(0,I.S)(),M=U.user,T=U.isPremiumUser,H=(0,S.V)(),z=(0,u.useMemo)((function(){return T?"Premium User":"Trial User"}),[M,T]),L="crust"===M.wallet,R=(0,F.Yg)(),K=(0,u.useRef)(null),Y=(0,u.useCallback)((function(){K.current&&K.current.click()}),[K]),$=(0,u.useCallback)((function(e){try{var r=new FileReader,s=e.target.files;if(!s)return;if(r.readAsText(s[0],"UTF-8"),!/(.json)$/i.test(e.target.value))return g.error(t("File error"));r.onload=function(e){var r,s=JSON.parse(null===(r=e.target)||void 0===r?void 0:r.result),i={files:[]};if(Array.isArray(s))i.files=s;else{if(!s.files||!Array.isArray(s.files))return g.error(t("File content error"));i.secret=s.secret,i.files=s.files}if(o.secret&&i.secret&&i.secret!==o.secret)return g.error("Two secrets were found, and they are different.");if(i.secret){var a=(0,w.hC)(i.secret);a&&o.set(a)}var c,l=[],u={},f=_(i.files);try{for(f.s();!(c=f.n()).done;){var d=c.value;d.Hash&&d.Name&&d.UpEndpoint&&d.PinEndpoint&&(l.push(d),u[d.Hash]=!0)}}catch(p){f.e(p)}finally{f.f()}var m=R.files.filter((function(e){return!u[e.Hash]}));R.setFiles([].concat(l,(0,n.Z)(m))),g.alert({msg:t("Import Success"),type:"success"})}}catch(e){g.alert({msg:t("File content error"),type:"error"})}}),[R,o.set,g,t]),B=(0,u.useCallback)((function(){var e={files:R.files,secret:o.secret},r=new Blob([JSON.stringify(e)],{type:"application/json; charset=utf-8"});c().saveAs(r,"backup.json")}),[R,o]);return(0,O.jsxs)(E.Z,{path:"/setting",className:r,children:[(0,O.jsx)("input",{onChange:$,ref:K,style:{display:"none"},type:"file"}),x&&(0,O.jsx)(P,{alert:g,size:"tiny",open:!0,toggleOpen:j,onSuccess:o.set}),(0,O.jsxs)(d.Z,{basic:!0,className:"mcard",children:[(0,O.jsx)("div",{className:"title font-sans-semibold",children:t("User Profile")}),(0,O.jsxs)("div",{className:"text font-sans-regular",children:["".concat(t("Web3 Identity Logged-in:")," "),(0,O.jsx)("span",{className:"bold-text font-sans-semibold",children:M.account})]}),(0,O.jsxs)("div",{className:"text font-sans-regular",children:["".concat(t("Logged-in Wallet:")," "),(0,O.jsx)("span",{className:"bold-text font-sans-semibold",children:F.w3[M.wallet]})]}),L&&M.nickName&&(0,O.jsxs)("div",{className:"text font-sans-regular",children:["".concat(t("Nick Name:")," "),(0,O.jsx)("span",{className:"bold-text font-sans-semibold",children:M.nickName})]}),(0,O.jsxs)("div",{className:"text font-sans-regular",children:["".concat(t("User Type:")," "),(0,O.jsx)("span",{className:"bold-text font-sans-semibold",children:z})," ",!T&&(0,O.jsx)("a",{onClick:function(){return a.push("/user")},rel:"noreferrer",children:"Get Premium"})]})]}),(0,O.jsxs)(d.Z,{basic:!0,className:"mcard",children:[(0,O.jsx)("div",{className:"title font-sans-semibold",children:t("User Data Management")}),(0,O.jsxs)("div",{className:"text font-sans-regular",children:["".concat(t("Your user data (including three File Lists and one File Encryption Key) are cached on your local devices. If you want to migrate your user data to a new device, use Export & Import function.")," "),(0,O.jsx)("span",{style:{color:"#f47e6b"},children:"Attention Please! If you want to switch device or explorer, please follow the following steps: 1) Export your user data from old device/explorer. 2) Log in to Crust Files in your new device/explorer. 3) Import the user data. 4) Enjoy Crust Files!"})]}),(0,O.jsxs)(m.Z,{children:[(0,O.jsx)(p.Z,{active:k,onClick:function(){return D()},children:(0,O.jsxs)("div",{className:"title font-sans-semibold",children:[t("File Encryption"),(0,O.jsx)("span",{className:i()("icon",k?"cru-fo-chevron-up":"cru-fo-chevron-down")})]})}),(0,O.jsxs)(h.Z,{active:k,className:"no-padding",children:[(0,O.jsxs)("div",{className:"text font-sans-regular",children:["".concat(t("Your File Encryption Key:")," "),o.secret&&(0,O.jsxs)("span",{className:"bold-text font-sans-semibold",children:[o.secret,(0,O.jsx)("span",{className:"icon cru-fo-copy",onClick:function(){return H(o.secret)}})]}),!o.secret&&(0,O.jsx)("a",{onClick:o.generate,children:"Generate a New"})]}),o.seeds&&(0,O.jsxs)("div",{className:"text font-sans-regular",children:["".concat(t("Seed Phrase:")," "),(0,O.jsx)("span",{className:"bold-text font-sans-semibold",children:o.seeds})]})]})]}),(0,O.jsxs)("div",{className:"btns",children:[(0,O.jsx)(b.Z,{content:t("Export"),onClick:B}),(0,O.jsx)(b.Z,{content:t("Import"),onClick:Y})]})]})]})})).withConfig({displayName:"setting",componentId:"sc-1rkrrxr-0"})([".pusl_center_flex_content{min-width:60rem;}.mcard{padding:1.71rem !important;box-shadow:0 0.71rem 1.71rem 0 rgba(0,0,0,0.06) !important;border-radius:1.14rem !important;border:0.07rem solid #EEEEEE !important;margin-top:2.21rem;.title{font-size:1.3rem !important;font-weight:600;color:var(--main-color);padding-bottom:1.14rem;.cru-fo{margin-right:0.8rem;}}.text{font-size:1rem;color:var(--secend-color);line-height:1.57rem;}.icon{margin-left:1rem;font-size:1.428571rem;position:relative;top:3px;cursor:pointer;}.bold-text{color:var(--main-color);}a{text-decoration:underline;line-height:1.2rem;cursor:pointer;}.btns{margin-top:1.7rem;button:first-child{margin-right:1rem;}}}"]))},63782:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/setting",function(){return t(8130)}])}},function(e){e.O(0,[729,914,335,441,774,888,179],(function(){return r=63782,e(e.s=r);var r}));var r=e.O();_N_E=r}]);