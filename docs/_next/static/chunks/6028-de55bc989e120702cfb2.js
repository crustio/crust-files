"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6028],{66028:function(e,t,r){r.d(t,{N:function(){return A}});var n=r(30266),s=r(809),i=r.n(s),c=r(9669),a=r.n(c),o=r(93162),u=r(56755),p=r.n(u),l=r(96486),f=r.n(l),d=r(67294),m=r(1300),h=r(22090),v=r(65382),y=r(29163),w=r(12752),b=r(54040),g=r(65369),x=r(20478),k=r(59996),j=r(45129),O=r(56262),C=r(99056),N=r(43064),S=r(60954),E=r(6169),Z=r(81496),P=r(85893),A=["https://crustipfs.live","https://crustipfs.art","https://crustipfs.info","https://web3files.world","https://web3files.live","https://storagefiles.site","https://storagefiles.space","https://crustipfs.tech"];function D(e,t,r){return"".concat(r,"/ipfs/").concat(e.Hash,"?filename=").concat(e.Name)}function T(e,t){return _.apply(this,arguments)}function _(){return(_=(0,n.Z)(i().mark((function e(t,r){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,j.Cn)(t.Hash,{name:t.Name,encrypted:t.Encrypted,gateway:t.UpEndpoint,fromAccount:r.account,fromWallet:r.wallet,from:r.nickName,isDir:!!t.items});case 2:return n=e.sent,(0,k.H)({type:3,walletType:r.wallet,address:r.account,data:{cid:t.Hash,fileType:t.items?1:0,strategy:t.Encrypted?1:0,shareType:0}}),e.abrupt("return","".concat(window.location.origin,"/share?code=").concat(n));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e){try{return JSON.parse(JSON.stringify(e))}catch(t){return{expired_at:0,reported_replica_count:0,amount:0,file_size:0,prepaid:!1}}}t.Z=d.memo((0,y.ZP)((function(e){var t,r,s,c,u=e.file,l=e.className,y=e.uc,k=e.onDelete,j=e.type,A="public"===(void 0===j?"public":j),_=(0,x.V)(),F=(0,d.useContext)(w.Il),L=F.api,M=F.alert,H=F.loading,R=(0,O.T)().endpoints,I=(0,Z.z)().gateway,U=(0,d.useCallback)((0,n.Z)(i().mark((function e(){var t,r,n,s,c,p;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u.Encrypted||0!==f().size(u.items)){e.next=29;break}if(e.prev=1,y.secret){e.next=4;break}return e.abrupt("return");case 4:return H.show(),t=D(u,0,I),e.next=8,a().get(t,{responseType:"arraybuffer"});case 8:return r=e.sent,console.info("res::",r),n=(new Date).getTime(),e.next=13,(0,b.n)(r.data,y.secret);case 13:if(s=e.sent,console.info("decrypt:",((new Date).getTime()-n)/1e3),s){e.next=17;break}throw"error";case 17:console.info("de:",s),c=new File([s],u.Name,{type:r.headers["content-type"]}),(0,o.saveAs)(c,u.Name),H.hide(),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(1),H.hide(),M.error("Decrypt error");case 27:e.next=31;break;case 29:p=D(u,0,I),window.open(p,"_blank");case 31:case"end":return e.stop()}}),e,null,[[1,23]])}))),[y,u,R,I]),q=(0,N.WY)(),K=function(){var e=(0,n.Z)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T(u,q);case 3:t=e.sent,window.open(t,"_blank"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),M.error((0,C.az)(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=(0,n.Z)(i().mark((function e(){var t,r,n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T(u,q);case 3:t=e.sent,r=q.nickName?"Check out what '".concat(q.nickName,"' is sharing on Crust Files!"):"Check out what I am sharing on Crust Files!",n="https://twitter.com/intent/tweet?text=".concat(encodeURI(r),"&url=").concat(encodeURIComponent(t),"&hashtags=web3,ipfs,crustnetwork,metaverse,crustfiles"),window.open(n,"_blank"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),M.error((0,C.az)(e.t0));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),W=L&&(null===(t=L.query)||void 0===t?void 0:t.market)&&((0,E.m)(L.query.market.filesV2)?L.query.market.filesV2:L.query.market.files),B=L&&(null===(r=L.query)||void 0===r?void 0:r.market)&&L.query.market.files,G=!!W,J=(0,g.W7)(W,[u.Hash]),$=(0,g.W7)(B,[u.Hash]),Q=(0,g.W7)(null===L||void 0===L||null===(s=L.derive)||void 0===s||null===(c=s.chain)||void 0===c?void 0:c.bestNumber),Y=Q&&Q.toNumber(),X=(0,d.useMemo)((function(){var e={status:"Submitted"};if($&&!$.isEmpty){var t=z($),r=t.expired_at,n=t.reported_replica_count,s=t.amount,i=t.file_size,c=t.prepaid;e.expireTime=r,e.amount=s,e.startTime=r?r-216e3:0,e.fileSize=i,e.confirmedReplicas=n,e.prepaid=c,r&&r<Y&&(e.status="Expired"),n<1&&(e.status="Submitted"),r&&r>Y&&n>0&&(e.status="Success")}else if(J&&!J.isEmpty){var a=z(J),o=a.expired_at,p=a.reported_replica_count,l=a.amount,f=a.file_size,d=a.prepaid;e.expireTime=o,e.amount=l,e.startTime=o?o-216e3:0,e.fileSize=f,e.confirmedReplicas=p,e.prepaid=d,o&&o<Y&&(e.status="Expired"),p<1&&(e.status="Submitted"),o&&o>Y&&p>0&&(e.status="Success")}else G&&(new Date).getTime()-u.PinTime>=72e5&&(e.status="Failed");return Y||(e.status="Loading"),e}),[$,J,Y]);return(0,P.jsxs)(m.Z.Row,{className:l,children:[(0,P.jsxs)(m.Z.Cell,{className:"fileName",children:[(0,C.lS)(u.Name),u.items&&(0,P.jsx)("span",{className:"icon cru-fo-folder"}),u.Encrypted&&(0,P.jsx)(h.Z,{trigger:(0,P.jsx)("span",{className:"icon cru-fo-key"}),content:"Encrypted",position:"top center"})]}),(0,P.jsxs)(m.Z.Cell,{textAlign:"right",children:[(0,C.lS)(u.Hash),(0,P.jsx)(h.Z,{position:"top center",content:"Copy File CID",trigger:(0,P.jsx)("span",{className:"cru-fo cru-fo-copy",onClick:function(){return _(u.Hash)},style:{marginLeft:"1.8rem"}})})]}),(0,P.jsx)(m.Z.Cell,{textAlign:"center",style:{textTransform:"uppercase"},children:p()(Number(u.Size),{round:2})}),(0,P.jsxs)(m.Z.Cell,{textAlign:"center",children:["Loading"===X.status&&(0,P.jsx)(v.Z,{loading:!0,name:"spinner"}),"Submitted"===X.status&&X.status,"Expired"===X.status&&X.status,"Failed"===X.status&&X.status,"Success"===X.status&&"".concat(X.status," (").concat(X.confirmedReplicas," Replicas)")]}),(0,P.jsxs)(m.Z.Cell,{textAlign:"center",children:[(0,P.jsx)(h.Z,{position:"top center",content:"Open",trigger:(0,P.jsx)("span",{className:"cru-fo cru-fo-external-link",style:{marginLeft:"1rem"},onClick:U})}),(0,P.jsx)(h.Z,{position:"top center",content:"Delete",trigger:(0,P.jsx)("span",{className:"cru-fo cru-fo-trash-2",style:{marginLeft:"1rem"},onClick:function(){k(u)}})}),(0,P.jsx)(h.Z,{position:"top center",content:"IPFS Scan",trigger:(0,P.jsx)("span",{className:"cru-fo cru-fo-search",style:{marginLeft:"1rem"},onClick:function(){window.open("https://ipfs-scan.io?cid=".concat(u.Hash),"_blank")}})})]}),A&&(0,P.jsx)(m.Z.Cell,{textAlign:"center",children:(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(S.Z,{className:"item-share-btn",onClick:K,children:"Share"}),(0,P.jsx)(h.Z,{position:"top center",content:"Quick Tweet",trigger:(0,P.jsx)("span",{className:"cru-fo cru-fo-twitter",onClick:V,style:{marginLeft:"0.5rem",top:"0.2rem"}})})]})})]})})).withConfig({displayName:"FileItem",componentId:"sc-3bbeav-0"})(["color:var(--secend-color) !important;.cru-fo,.icon{cursor:pointer;font-size:1.3rem;position:relative;top:0.3rem;}.fileName{.icon{margin-left:0.6rem;}}.item-share-btn{padding:5px 11px !important;border-radius:8px !important;}"]))},54040:function(e,t,r){r.d(t,{P:function(){return o},n:function(){return u}});var n=r(30266),s=r(809),i=r.n(s),c=function(){var e=(0,n.Z)(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.crypto.subtle.importKey("raw",t,"PBKDF2",!1,["deriveKey"]));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a=function(){var e=(0,n.Z)(i().mark((function e(t,r,n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.crypto.subtle.deriveKey(n,t,{name:"AES-GCM",length:256},!1,r));case 1:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),o=function(){var e=(0,n.Z)(i().mark((function e(t,r){var n,s,o,u,p,l,f,d,m;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=new Uint8Array(t),s=(new TextEncoder).encode(r),o=window.crypto.getRandomValues(new Uint8Array(16)),u=window.crypto.getRandomValues(new Uint8Array(12)),e.next=7,c(s);case 7:return p=e.sent,e.next=10,a(p,["encrypt"],{name:"PBKDF2",salt:o,iterations:25e4,hash:"SHA-256"});case 10:return l=e.sent,e.next=13,window.crypto.subtle.encrypt({name:"AES-GCM",iv:u},l,n);case 13:return f=e.sent,d=new Uint8Array(f),(m=new Uint8Array(d.byteLength+o.byteLength+u.byteLength)).set(o,0),m.set(u,o.byteLength),m.set(d,o.byteLength+u.byteLength),e.abrupt("return",m);case 22:throw e.prev=22,e.t0=e.catch(0),console.error("Error encrypting file"),console.error(e.t0),e.t0;case 27:case"end":return e.stop()}}),e,null,[[0,22]])})));return function(t,r){return e.apply(this,arguments)}}(),u=function(){var e=(0,n.Z)(i().mark((function e(t,r){var n,s,o,u,p,l,f,d;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=new Uint8Array(t),s=(new TextEncoder).encode(r),o=n.slice(0,16),u=n.slice(16,28),p=n.slice(28),e.next=8,c(s);case 8:return l=e.sent,e.next=11,a(l,["decrypt"],{name:"PBKDF2",salt:o,iterations:25e4,hash:"SHA-256"});case 11:return f=e.sent,e.next=14,window.crypto.subtle.decrypt({name:"AES-GCM",iv:u},f,p);case 14:return d=e.sent,e.abrupt("return",d);case 18:return e.prev=18,e.t0=e.catch(0),console.error("Error decrypting file"),console.error(e.t0),e.abrupt("return");case 23:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t,r){return e.apply(this,arguments)}}()},65369:function(e,t,r){r.d(t,{W7:function(){return p}});var n=r(80318),s=r(83789),i=r(67294),c=r(66103),a=r(98278);function o(e){return e}function u(e){e.current.isActive=!1,e.current.subscriber&&(e.current.subscriber.then((function(e){return e()})).catch(console.error),e.current.subscriber=null)}function p(e,t,r){var p=function(){var e=(0,i.useRef)(!1);return(0,i.useEffect)((function(){return e.current=!0,function(){e.current=!1}}),[]),e}(),l=(0,i.useRef)({isActive:!1,serialized:null,subscriber:null}),f=(0,i.useState)((r||{}).defaultValue),d=f[0],m=f[1];return(0,i.useEffect)((function(){return function(){return u(l)}}),[]),(0,i.useEffect)((function(){if(p.current&&e){var i=function(e,t){var r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).paramMap,n=void 0===r?o:r;return[JSON.stringify({f:null===e||void 0===e?void 0:e.name,p:t}),0!==t.length&&t.some((function(e){return(0,c.F)(e)||(0,a.o)(e)}))?null:n(t)]}(e,t||[],r),f=(0,n.Z)(i,2),d=f[0],h=f[1];h&&d!==l.current.serialized&&(l.current.serialized=d,function(e,t,r,n,i){var c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},p=c.transform,l=void 0===p?o:p,f=c.withParams,d=c.withParamsTransform,m=n.filter((function(e){return!(0,a.o)(e)}));u(t),setTimeout((function(){var c;e.current&&(!r||r.meta&&null!==(c=r.meta.type)&&void 0!==c&&c.isDoubleMap&&2!==m.length?t.current.subscriber=null:(t.current.isActive=!0,t.current.subscriber=r.apply(void 0,(0,s.Z)(n).concat([function(r){e.current&&t.current.isActive&&e.current&&t.current.isActive&&i(f?[n,l(r)]:l(d?[n,r]:r))}]))))}),0)}(p,l,e,h,m,r))}}),[e,r,p,t]),d}},81496:function(e,t,r){r.d(t,{N:function(){return u},z:function(){return p}});var n=r(92809),s=r(67294),i=r(58971),c=r.n(i);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var u=[{text:"https://ipfs.io",value:"https://ipfs.io"},{text:"https://crustipfs.mobi",value:"https://crustipfs.mobi"},{text:"https://crust.fans",value:"https://crust.fans"},{text:"https://crustipfs.world",value:"https://crustipfs.world"},{text:"https://crustgateway.online",value:"https://crustgateway.online"},{text:"https://crustipfs.info",value:"https://crustipfs.info"},{text:"https://gw.w3ipfs.org.cn",value:"https://gw.w3ipfs.org.cn"},{text:"https://crustipfs.art",value:"https://crustipfs.art"}];function p(){var e=(0,s.useState)({gateway:"https://ipfs.io"}),t=e[0],r=e[1];(0,s.useEffect)((function(){var e=c().get("downloadgateway");e&&r(e)}),[]);var n=(0,s.useCallback)((function(e){var t={gateway:e};r(t),c().set("downloadgateway",t)}),[]);return(0,s.useMemo)((function(){return o(o({},t),{},{set:n})}),[t,n])}},56262:function(e,t,r){r.d(t,{T:function(){return l},q:function(){return f}});var n=r(92809),s=r(67294),i=r(75282),c=r(25443),a=r(58971),o=r.n(a);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"upload:last-gateway",t=(0,c.$)(),r=t.t,n=(0,s.useMemo)((function(){return(0,i.Dl)(r).map((function(e){var t,r;return p(p({},e),{},{text:"".concat(null!==(t=e.text)&&void 0!==t?t:""," (").concat(null!==(r=e.location)&&void 0!==r?r:"",")")})}))}),[r]),a=(0,s.useMemo)((function(){var t=o().get(e);if(t){var r=n.findIndex((function(e){return e.value===t.value}));if(r>=0)return r}return 0}),[e,n]),u=(0,s.useState)(n[a]),l=u[0],f=u[1],d=(0,s.useCallback)((function(t){f((function(r){var n="function"===typeof t?t(r):t;return o().set(e,{value:n.value}),n}))}),[]),m=(0,s.useCallback)((function(e,t){var r=t.value,s=n.find((function(e){return e.value===r}));s&&d(s)}),[n,d]);return(0,s.useMemo)((function(){return{endpoints:n,endpoint:l,setEndpoint:d,onChangeEndpoint:m}}),[n,l,d,m])}function f(){var e=(0,c.$)().t,t=(0,s.useMemo)((function(){return(0,i.qi)(e).sort((function(){return Math.random()>.5?-1:1})).map((function(e){var t;return p(p({},e),{},{text:"".concat(null!==(t=e.text)&&void 0!==t?t:"Pinner")})}))}),[e]),r=(0,s.useState)(t[0]),n=r[0],a=r[1],o=(0,s.useCallback)((function(e,r){var n=r.value,s=t.find((function(e){return e.value===n}));s&&a(s)}),[t]);return(0,s.useMemo)((function(){return{pinner:n,pins:t,setPinner:a,onChangePinner:o}}),[n,t,o])}}}]);